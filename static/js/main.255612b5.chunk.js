(this["webpackJsonpwork-log-bottle-project"]=this["webpackJsonpwork-log-bottle-project"]||[]).push([[0],{175:function(e,t,n){"use strict";n.r(t);var c=n(4),r=n(1),a=n.n(r),i=n(23),o=n.n(i),s=(n(90),n(9)),l=n(84),u=n(50),d=n.n(u),j=[0],m=["Olivia","Emma","Ava","Sophia","Isabella"].map((function(e,t){return{name:e,id:t,image:"https://randomuser.me/api/portraits/women/".concat(t,".jpg"),isAdmin:j.indexOf(t)>-1}})),b={DOMAIN:"https://bottle-work-log-api-project.herokuapp.com",getAllEmployees:function(){return m},getLogsForEmployee:function(e){return d.a.get(this.DOMAIN+"/logs?employeeId="+e).then((function(e){return e.data}))},createLog:function(e){return d.a.post(this.DOMAIN+"/logs",e).then((function(e){return e.data}))},getLogs:function(){return d.a.get(this.DOMAIN+"/logs").then((function(e){return e.data}))},populateDummyData:function(){var e=this;this.getAllEmployees().forEach((function(t){var n=t.id;Array(30).fill(1).map((function(e,t){return e+t})).forEach((function(t){var c="2020/12/"+t,r="Normal work "+c;e.createLog({date:c,start_time:"1:00",end_time:"3:00",remarks:r,employeeId:n})}))}))}},O=n(22),v=n(12),h=n(26),p=n.n(h),f=n(51),g=n.n(f),x=(n(113),function(){var e=Object(v.c)((function(e){return e})),t=Object(v.b)(),n=a.a.useState(new Date),r=Object(O.a)(n,2),i=r[0],o=r[1],s=a.a.useState(new Date),l=Object(O.a)(s,2),u=l[0],d=l[1],j=a.a.useState(!1),m=Object(O.a)(j,2),h=m[0],f=m[1],x=a.a.useState(new Date),y=Object(O.a)(x,2),E=y[0],S=y[1];return Object(c.jsxs)("div",{className:"form-container",children:[Object(c.jsx)("div",{class:"time-form-container",children:Object(c.jsxs)("form",{onSubmit:function(n){n.preventDefault();var c=n.target.querySelector("[name=remarks]").value.trim();if(c){var r={date:i,start_time:u,end_time:E,remarks:c,employeeId:e.currentUser.id};r.date=p()(r.date).format("DD/MM/YYYY"),r.start_time=p()(r.start_time).format("HH:mm"),r.end_time=p()(r.end_time).format("HH:mm"),f(!0),b.createLog(r).then((function(e){t({type:"CREATE_LOG",log:e})})).catch(alert).finally((function(){f(!1)}))}else alert("Remarks cant be left empty")},children:[Object(c.jsx)("input",{className:"remarks-text-box",name:"remarks",type:"text",placeholder:"What were you doing?"}),Object(c.jsxs)("div",{className:"time-picker-container",children:[Object(c.jsx)(g.a,{selected:i,onChange:function(e){return o(e)}}),Object(c.jsx)(g.a,{selected:u,onChange:function(e){return d(e)},showTimeSelect:!0,showTimeSelectOnly:!0,timeIntervals:15,timeCaption:"Time",dateFormat:"h:mm aa"}),Object(c.jsx)(g.a,{selected:E,onChange:function(e){return S(e)},showTimeSelect:!0,showTimeSelectOnly:!0,timeIntervals:15,timeCaption:"Time",dateFormat:"h:mm aa"})]}),Object(c.jsx)("input",{type:"submit",value:"Update"})]})}),Object(c.jsxs)("div",{children:[h&&Object(c.jsx)("div",{class:"loading",children:"SUBMITTING LOG..."}),e&&e.logs&&e.logs.filter((function(t){var n;return t.employeeId===(null===e||void 0===e||null===(n=e.currentUser)||void 0===n?void 0:n.id)})).map((function(e){return Object(c.jsxs)("div",{className:"user-log",children:[Object(c.jsx)("div",{children:e.date}),Object(c.jsx)("div",{children:e.remarks}),Object(c.jsx)("div",{children:e.employeeId}),Object(c.jsx)("div",{children:"".concat(e.start_time," > ").concat(e.end_time)})]})}))]})]})}),y=n(40),E=n(32),S=function(){var e,t=Object(v.c)((function(e){return e})),n=a.a.useState("1D"),r=Object(O.a)(n,2),i=r[0],o=r[1],s=function(e){var t=e.target;o(t.value),console.log({selected:i})},l=a.a.useMemo((function(){var e=null===t||void 0===t?void 0:t.logs,n={};return e.forEach((function(e){var c=null===t||void 0===t?void 0:t.employees.find((function(t){return e.employeeId===t.id})).name;n[c]||(n[c]={}),n[c][e.date]||(n[c][e.date]=0);var r=p()("2000-01-01 ".concat(e.start_time)),a=p()("2000-01-01 ".concat(e.end_time)).diff(r,"minutes",!0),i=parseFloat(a/60);n[c][e.date]+=i})),n}),[null===t||void 0===t?void 0:t.logs,null===t||void 0===t?void 0:t.employees]),u=function(e,t){var n={};return Object.keys(e).forEach((function(c){var r=function(e,t){return e.reduce((function(n,c,r){return r%t?n:[].concat(Object(E.a)(n),[e.slice(r,r+t)])}),[])}(Object.entries(e[c]),t).map((function(e,t){return Object(y.a)({},t+1,e.reduce((function(e,t){var n=Object(O.a)(t,2);n[0];return n[1]+e}),0))}));n[c]=r})),n};return Object(c.jsxs)("div",{children:[Object(c.jsxs)("div",{className:"time-interval-container",children:[Object(c.jsx)("input",{type:"button",value:"1D",onClick:s}),Object(c.jsx)("input",{type:"button",value:"1W",onClick:s}),Object(c.jsx)("input",{type:"button",value:"1M",onClick:s})]}),"1D"===i&&Object(c.jsxs)("div",{children:[Object(c.jsx)("h1",{children:"1D"}),Object(c.jsx)("pre",{children:JSON.stringify(l,null,4)})]}),"1W"===i&&Object(c.jsxs)("div",{children:[Object(c.jsx)("h1",{children:"1W"}),Object(c.jsx)("pre",{children:JSON.stringify((e=l,u(e,7)),null,4)})]}),"1M"===i&&Object(c.jsxs)("div",{children:[Object(c.jsx)("h1",{children:"1M"}),Object(c.jsx)("pre",{children:JSON.stringify(function(e){return u(e,30)}(l),null,4)})]})]})},U=function(e){var t=e.image,n=e.isAdmin,r=e.name,a=e.onClick;return Object(c.jsxs)("div",{className:"profile-wrapper",children:[Object(c.jsx)("img",{src:t,alt:"image"}),Object(c.jsx)("span",{children:n?"admin":"user"}),Object(c.jsxs)("button",{onClick:function(){return a(e)},children:["Login as ",r]})]})},_=n(8),k=function(){var e=Object(_.g)(),t=Object(v.c)((function(e){return e})),n=Object(v.b)(),r=function(t){n({type:"SET_CURRENT_USER",currentUser:t}),e.push("/")};return Object(c.jsx)("div",{className:"login-container",children:null===t||void 0===t?void 0:t.employees.map((function(e){return Object(c.jsx)(U,Object(s.a)(Object(s.a)({},e),{},{onClick:r}))}))})},N=n(25);function A(e){var t=e.component,n=e.authed,r=Object(l.a)(e,["component","authed"]);return Object(c.jsx)(_.b,Object(s.a)(Object(s.a)({},r),{},{exact:!0,render:function(e){return n?Object(c.jsx)(t,Object(s.a)({},e)):Object(c.jsx)(_.a,{to:{pathname:"/login",state:{from:e.location}}})}}))}var w=function(){var e,t,n,r,i,o,s,l=Object(v.b)(),u=Object(v.c)((function(e){return e}));a.a.useEffect((function(){var e=b.getAllEmployees();l({type:"UPDATE_EMPLOYEES",employees:e}),b.getLogs().then((function(e){l({type:"UPDATE_LOGS",logs:e})}))}),[l]),a.a.useEffect((function(){var e;(null===u||void 0===u||null===(e=u.currentUser)||void 0===e?void 0:e.name)?(document.querySelector("#login-nav").style.display="none",document.querySelectorAll(".auth-nav").forEach((function(e){e.style.display="inline-block"}))):(document.querySelectorAll(".auth-nav").forEach((function(e){e.style.display="none"})),document.querySelector("#login-nav").style.display="inline-block")}),[u]);var d=function(){return Object(c.jsxs)("nav",{children:[Object(c.jsx)(N.b,{className:"auth-nav",to:"/",children:"Home"}),Object(c.jsx)(N.b,{className:"auth-nav",to:"/show_logs",children:"Show All Users Time Logs"}),Object(c.jsx)(N.b,{id:"login-nav",to:"/login",children:"Login"}),Object(c.jsx)("a",{id:"logout-button",href:"#",className:"auth-nav",onClick:function(){l({type:"CLEAR_CURRENT_USER"})},children:"Logout"})]})};return Object(c.jsxs)("main",{children:[Object(c.jsx)(d,{}),(null===u||void 0===u||null===(e=u.currentUser)||void 0===e?void 0:e.name)&&Object(c.jsxs)("div",{className:"nav-profile-wrapper",children:[Object(c.jsx)("img",{src:null===u||void 0===u||null===(t=u.currentUser)||void 0===t?void 0:t.image}),Object(c.jsxs)("h1",{children:[null===u||void 0===u||null===(n=u.currentUser)||void 0===n?void 0:n.name," ",Object(c.jsxs)("span",{children:["(",(null===u||void 0===u||null===(r=u.currentUser)||void 0===r?void 0:r.isAdmin)?"admin":"user",")"]})]})]}),Object(c.jsx)("div",{className:"container",children:Object(c.jsxs)(_.d,{children:[!(null===u||void 0===u||null===(i=u.currentUser)||void 0===i?void 0:i.name)&&Object(c.jsx)(_.b,{path:"/login",component:k,exact:!0}),Object(c.jsx)(A,{authed:null===u||void 0===u||null===(o=u.currentUser)||void 0===o?void 0:o.name,path:"/",exact:!0,component:x}),Object(c.jsx)(A,{authed:null===u||void 0===u||null===(s=u.currentUser)||void 0===s?void 0:s.name,path:"/show_logs",exact:!0,component:S})]})})]})},T=n(42),C="CREATE_LOG",D="UPDATE_EMPLOYEES",L="UPDATE_LOGS",R="SET_CURRENT_USER",I="CLEAR_CURRENT_USER",M={logs:[],employees:[],currentUser:{}};var G=Object(T.b)((function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:M,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case C:return Object(s.a)(Object(s.a)({},e),{},{logs:[].concat(Object(E.a)(e.logs),[t.log])});case D:return Object(s.a)(Object(s.a)({},e),{},{employees:[].concat(Object(E.a)(t.employees),Object(E.a)(e.employees))});case L:return Object(s.a)(Object(s.a)({},e),{},{logs:t.logs});case R:return Object(s.a)(Object(s.a)({},e),{},{currentUser:t.currentUser});case I:return Object(s.a)(Object(s.a)({},e),{},{currentUser:{}})}}));o.a.render(Object(c.jsx)(a.a.StrictMode,{children:Object(c.jsx)(v.a,{store:G,children:Object(c.jsx)(N.a,{children:Object(c.jsx)(w,{})})})}),document.getElementById("root"))},90:function(e,t,n){}},[[175,1,2]]]);
//# sourceMappingURL=main.255612b5.chunk.js.map